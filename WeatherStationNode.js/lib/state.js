function initStateJS(g){function r(a,b){var c,f,d;c=0;for(f=a.length;c<f;c+=1)if(b(a[c])){if(d)throw"single found more than one result";d=a[c]}return d}function m(a,b){if(a.steelbreeze_statejs_active)return a.steelbreeze_statejs_active[b]}function h(a,b){if(a.steelbreeze_statejs_current)return a.steelbreeze_statejs_current[b]}function n(a,b,c){this.guard=c||function(a){return!0};if(b&&null!==b){for(var f=a.owner.ancestors(),d=b.owner.ancestors(),e=0;f.length>e&&d.length>e&&f[e]===d[e];)e+=1;this.sourceAncestorsToExit=
f.slice(e);this.targetAncestorsToEnter=d.slice(e);this.sourceAncestorsToExit.reverse();this.source=a;this.target=b}a[c&&1<c.length?"transitions":"completions"].push(this)}function v(a,b){if(1===b.length)return b[0];throw"initial pseudo states must have one and only one outbound transition";}function d(a,b){this.name=a;this.owner=b}function t(a,b,c){d.call(this,a,c);this.kind=b;this.completions=[];this.kind.isInitial&&(this.owner.initial=this)}function e(a,b){d.call(this,a,b);this.completions=[];this.transitions=
[]}function p(a,b){e.call(this,a,b)}function q(a,b){e.call(this,a,b);this.regions=[]}function s(a,b){e.call(this,a,b);this.isFinalState=!0}function k(a,b){d.call(this,a,b);this.initial=null;this.owner&&this.owner.regions.push(this)}function l(a){d.call(this,a);this.regions=[]}n.prototype.onEffect=function(a,b){var c,f;if(this.effect)for(c=0,f=this.effect.length;c<f;c+=1)this.effect[c](a,b)};n.prototype.traverse=function(a,b){var c,f;if(this.source)for(this.source.beginExit(a),this.source.endExit(a),
c=0,f=this.sourceAncestorsToExit.length;c<f;c+=1)this.sourceAncestorsToExit[c].endExit(a);this.onEffect(a,b);if(this.target){c=0;for(f=this.targetAncestorsToEnter.length;c<f;c+=1)this.targetAncestorsToEnter[c].beginEntry(a);this.target.beginEntry(a);this.target.endEntry(a,!1)}};n.Else=function(a,b){n.call(this,a,b,function(a){return!1});this.isElse=!0};n.Else.prototype=n.prototype;n.Else.prototype.constructor=n.Else;var u={Choice:{isInitial:!1,isHistory:!1,completions:function(a,b){var c,f,d=[];c=
0;for(f=b.length;c<f;c+=1)b[c].guard(a)&&d.push(b[c]);return 0<d.length?d[(d.length-1)*Math.random()]:r(b,function(a){return a.isElse})}},DeepHistory:{isInitial:!0,isHistory:!0,completions:v},Initial:{isInitial:!0,isHistory:!1,completions:v},Junction:{isInitial:!1,isHistory:!1,completions:function(a,b){var c=r(b,function(b){return b.guard(a)});if(c||(c=r(b,function(a){return a.isElse})))return c;throw"junction PseudoState has no valid competion transitions";}},ShallowHistory:{isInitial:!0,isHistory:!0,
completions:v},Terminate:{isInitial:!1,isHistory:!1,completions:null}};d.prototype.qualifiedName=function(){return this.owner?this.owner+"."+this.name:this.name};d.prototype.ancestors=function(){return(this.owner?this.owner.ancestors():[]).concat(this)};d.prototype.beginExit=function(a){};d.prototype.endExit=function(a){console.log("Leave: "+this.toString());a.steelbreeze_statejs_active||(a.steelbreeze_statejs_active=[]);a.steelbreeze_statejs_active[this]=!1};d.prototype.beginEntry=function(a){m(a,
this)&&(this.beginExit(a),this.endExit(a));console.log("Enter: "+this.toString());a.steelbreeze_statejs_active||(a.steelbreeze_statejs_active=[]);a.steelbreeze_statejs_active[this]=!0};d.prototype.endEntry=function(a,b){};d.prototype.getCurrent=function(a){return{name:this.name}};d.prototype.toString=function(){return this.qualifiedName()};t.prototype=new d;t.prototype.constructor=t;t.prototype.endEntry=function(a,b){this.kind===u.Terminate?a.IsTerminated=!0:this.kind.completions(a,this.completions).traverse(a,
b)};e.prototype=new d;e.prototype.constructor=e;e.prototype.isComplete=function(a){return!0};e.prototype.onExit=function(a){var b,c;if(this.exit)for(b=0,c=this.exit.length;b<c;b+=1)this.exit[b](a)};e.prototype.endExit=function(a){this.onExit(a);d.prototype.endExit.call(this,a)};e.prototype.onEntry=function(a){var b,c;if(this.entry)for(b=0,c=this.entry.length;b<c;b+=1)this.entry[b](a)};e.prototype.beginEntry=function(a){d.prototype.beginEntry.call(this,a);if(this.owner){var b=this.owner;a.steelbreeze_statejs_current||
(a.steelbreeze_statejs_current=[]);a.steelbreeze_statejs_current[b]=this}this.onEntry(a)};e.prototype.endEntry=function(a,b){this.evaluateCompletions(a,b)};e.prototype.evaluateCompletions=function(a,b){if(this.isComplete(a)){var c=r(this.completions,function(b){return b.guard(a)});c&&c.traverse(a,b)}};e.prototype.process=function(a,b){var c=r(this.transitions,function(c){return c.guard(a,b)});if(!c)return!1;c.traverse(a,b);return!0};p.prototype=new e;p.prototype.constructor=p;p.prototype.isComplete=
function(a){var b=h(a,this);return a.isTerminated||null===b||b.isFinalState||!1===m(a,b)};p.prototype.beginExit=function(a){var b=h(a,this);b&&(b.beginExit(a),b.endExit(a))};p.prototype.endEntry=function(a,b){var c=(b||this.initial.kind.isHistory?h(a,this):this.initial)||this.initial;c.beginEntry(a);c.endEntry(a,b||this.initial.kind===u.DeepHistory);e.prototype.endEntry.call(this,a,b)};p.prototype.process=function(a,b){var c=e.prototype.process.call(this,a,b)||h(a,this).process(a,b);!0===c&&this.evaluateCompletions(a,
!1);return c};p.prototype.getCurrent=function(a){var b=d.prototype.getCurrent.call(this,a),c=h(a,this);c&&(b.current=c.getCurrent(a));return b};q.prototype=new e;q.prototype.constructor=q;q.prototype.isComplete=function(a){var b,c;if(!a.isTerminated)for(b=0,c=this.regions.length;b<c;b+=1)if(!this.regions[b].isComplete(a))return!1;return!0};q.prototype.beginExit=function(a){var b,c;b=0;for(c=this.regions.length;b<c;b+=1)m(a,this.regions[b])&&(this.regions[b].beginExit(a),this.regions[b].endExit(a))};
q.prototype.endEntry=function(a,b){var c,d;c=0;for(d=this.regions.length;c<d;c+=1)this.regions[c].beginEntry(a),this.regions[c].endEntry(a);e.prototype.endEntry.call(this,a,b)};q.prototype.process=function(a,b){var c,d,g=!1;if(!a.isTerminated&&!1===(g=e.prototype.process.call(this,a,b)))for(c=0,d=this.regions.length;c<d;c+=1)g=this.regions[c].process(a,b)||g;!0===g&&this.evaluateCompletions(a,!1);return g};q.prototype.getCurrent=function(a){var b=d.prototype.getCurrent.call(this,a),c,e;b.regions=
[];c=0;for(e=this.regions.length;c<e;c+=1)m(a,this.regions[c])&&(b.regions[c]=this.regions[c].getCurrent(a));return b};s.prototype=new e;s.prototype.constructor=s;delete s.prototype.comlpetions;delete s.prototype.transitions;s.prototype.process=function(a,b){return!1};k.prototype=new d;k.prototype.constructor=k;k.prototype.isComplete=function(a){var b=h(a,this);return a.isTerminated||null===b||b.isFinalState||!1===m(a,b)};k.prototype.initialise=function(a){this.beginEntry(a);this.endEntry(a,!1)};
k.prototype.beginExit=function(a){var b=h(a,this);b&&(b.beginExit(a),b.endExit(a))};k.prototype.endEntry=function(a,b){var c=(b||this.initial.kind.isHistory?h(a,this):this.initial)||this.initial;c.beginEntry(a);c.endEntry(a,b||this.initial.kind===u.DeepHistory)};k.prototype.process=function(a,b){return a.isTerminated?!1:m(a,this)&&h(a,this).process(a,b)};k.prototype.getCurrent=function(a){var b=d.prototype.getCurrent.call(this,a),c=h(a,this);c&&(b.current=c.getCurrent(a));return b};l.prototype=new d;
l.prototype.constructor=l;l.prototype.isComplete=function(a){var b,c;if(!a.isTerminated)for(b=0,c=this.regions.length;b<c;b+=1)if(!this.regions[b].isComplete(a))return!1;return!0};l.prototype.initialise=function(a){this.beginEntry(a);this.endEntry(a,!1)};l.prototype.beginExit=function(a){var b,c;b=0;for(c=this.regions.length;b<c;b+=1)m(a,this.regions[b])&&(this.regions[b].beginExit(a),this.regions[b].endExit(a))};l.prototype.endEntry=function(a,b){var c,e;c=0;for(e=this.regions.length;c<e;c+=1)this.regions[c].beginEntry(a),
this.regions[c].endEntry(a,b);d.prototype.endEntry.call(this,a,b)};l.prototype.process=function(a,b){var c,d,e=!1;if(!a.isTerminated)for(c=0,d=this.regions.length;c<d;c+=1)e=this.regions[c].process(a,b)||e;return e};l.prototype.getCurrent=function(a){var b=d.prototype.getCurrent.call(this,a),c,e;b.regions=[];c=0;for(e=this.regions.length;c<e;c+=1)m(a,this.regions[c])&&(b.regions[c]=this.regions[c].getCurrent(a));return b};g.PseudoStateKind=u;g.PseudoState=t;g.SimpleState=e;g.CompositeState=p;g.OrthogonalState=
q;g.FinalState=s;g.Region=k;g.StateMachine=l;g.Transition=n}this.exports?initStateJS(this.exports):this.define?this.define(function(g,r,m){initStateJS(r)}):initStateJS(this);
